<style type="text/css">
  ul li label{
    width: 15em;
    display: inline-block;
  }
</style>
<% form_for(@seguimiento) do |f| %>
  <%= f.error_messages %>
<table  width="60%" align="center" >
  <tr >
    <td >
        <%= f.label :carpeta_id, 'Orden Servicio' %><br />
        <%= f.collection_select :carpeta_id, Carpeta.all(:order => 'orden_servicio ASC'), :id, :to_s, :include_blank => true %>
           
      <p>
        <label for="">Liquidador</label>
        <div id="liquidador"></div>
      </p>
      
      <td >  
        
          <label for="">Cliente</label><br />
          <div  id="cliente_nombre" ></div>
        
            
      <p>
        <label>Mercancia</label><br />
        <div id="mercancia"></div>
      </p>
      
    </td>
  </tr>
</table>
<br /> 

<table width="80%" align="center">
  <tr>
    <td width="45%" >
      <p>
        <%= f.label :recinto %><br />
        <%= f.text_field :recinto %>
      </p>
      <p>
        <%= f.label :regimen %><br />
        <%= f.text_field :regimen %>
      </p>
      <p>
        <%= f.label :elaboracion_dav %><br />
        <%= f.date_select :elaboracion_dav %>
      </p>
      <p>
       <%= f.label :elaboracion_dui %><br />
       <%= f.date_select :elaboracion_dui %>
      </p>
      <p>
        <%= f.label :validacion_dui %><br />
        <%= f.date_select :validacion_dui %>
      </p>
      <p>
        <%= f.label :numero_registro %><br />
        <%= f.text_field :numero_registro %>
      </p>
      <p>
        <%= f.label :pago_tributos %><br />
        <%= f.date_select :pago_tributos %>
      </p>
      <p>
        <%= f.label :canal %><br />
        <%= f.text_field :canal %>
      </p>
      <p>
        <%= f.label :imprecion_dui_dav %><br />
        <%= f.date_select :imprecion_dui_dav %>
      </p>
    </td>  
    <td width="45%" >  
      <p>
        <%= f.label :presentacion_carpeta %><br />
        <%= f.date_select :presentacion_carpeta %>
      </p>
      <p>
        <%= f.label :tecnico_aduana %><br />
        <%= f.text_field :tecnico_aduana %>
      </p>
      <p>
        <%= f.label :levante_mercancia %><br />
        <%= f.date_select :levante_mercancia %>
      </p>
      <p>
        <%= f.label :pago_almacenaje_entrega %><br />
        <%= f.date_select :pago_almacenaje_entrega %>
      </p>
      <p>
        <%= f.label :facturacion %><br />
        <%= f.date_select :facturacion %>
      </p>
      <p>
        <%= f.label :observaciones %><br />
        <%= f.text_area :observaciones, :rows => 12   %>
      </p>
    </td>
  </tr>
 </table>

      <p align="center">
        <%= f.submit 'Salvar' %>
      </p>
<% end %>

<script type="text/javascript">
jQuery(function($) {
  // Listado de clientes convertido a JSON
    var clientes = <%= Carpeta.all(:include => [:cliente, :personal] ).inject({}){ |h, v| h[v.id] = {:cliente => v.cliente.to_s, :liquidador => v.personal.to_s, :nit => v.cliente.nit_ci } ; h  }.to_json %>;

  function llenarCliente(id) {
    if(id) {
      var cliente = clientes[ id ];
      $('#cliente_nombre').html(cliente.cliente);
      $('#cliente_nit_ci').html(cliente.nit);
      $('#liquidador').html(cliente.liquidador);
      }else{
        $('#cliente_nombre').html('');
        $('#cliente_nit_ci').html('');
        $('#liquidador').html('');
      }
  }

  // Evento para poder ver clientes
  $('#documento_carpeta_id').bind('change keyup', function() {
    llenarCliente($(this).val())
  });

  if( $('#documento_carpeta_id').val() ) {
    llenarCliente($('#documento_carpeta_id').val());
  }
     

  $('ul.documentos input:checkbox').click(function() {
    $(this).parents('label:first').next('select').attr('disabled', !$(this).attr('checked') );
  });
});
</script>
